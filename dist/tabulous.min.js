var Tabulous=function(a){this.TUNING={GUITAR:{STANDARD:["e2","a2","d3","g3","b3","e4"]}};var b={};b.root="a",b.type="",b.tuning=this.TUNING.GUITAR.STANDARD,b.frets=24,b.span=5,this.settings=Lazy({}).assign(a).defaults(b).value(),this.setUp()};Tabulous.prototype.getTuning=function(){var a=function(a){return teoria.note(a)},b=Lazy(this.settings.tuning).map(a);return b},Tabulous.prototype.getBoard=function(){var a=Lazy.range(0,this.settings.frets),b=this.tuning,c=[];return Lazy(a).each(function(a){c[a]=[],b.each(function(b,d){var e=teoria.note.fromKey(b.key()+a);c[a][d]=e})}),c},Tabulous.prototype.getString=function(a){var b=Lazy.range(0,this.settings.frets),c=[a];return Lazy(b).each(function(a,b){c.push(teoria.note.fromKey(c[b].key()+1))}),c},Tabulous.prototype.getChord=function(){var a=teoria.note(this.settings.root).chord(this.settings.type);return a},Tabulous.prototype.getNotes=function(){var a=Lazy(this.chord.notes()).map(function(a){return a});return a},Tabulous.prototype.getVoicings=function(a,b){var b=b||[],a=a||0,c=[],d=Lazy.range(a,a+this.settings.span),e=Lazy(this.tuning),f=Lazy(this.notes.toArray()).map(function(a){return a.name()+a.accidental()}).toArray(),g=e.map(function(){return-1}).toArray(),h=e.map(function(){return null}).toArray();d.each(function(a){e.each(function(b,d){var e=teoria.note.fromKey(b.key()+a),i=e.enharmonics(!0).length?e.enharmonics(!0)[0].name()+e.enharmonics(!0)[0].accidental():"",j=e.name()+e.accidental(),k=Lazy(f).contains(j)||Lazy(f).contains(i),l=Lazy(c).contains(d);!0===k&&!1===l&&(c.push(d),g[d]=a,h[d]=e)})});var i=Lazy(Lazy(b).last()).compact().sortBy().last(),j=Lazy(g).compact().sortBy().last(),k=12>i&&j>12?12:j,l=a+this.settings.span<this.settings.frets;return b.push({voicing:g,data:h}),!0===l?this.getVoicings(k,b):b},Tabulous.prototype.setUp=function(){this.tuning=this.getTuning(),this.board=this.getBoard(),this.chord=this.getChord(),this.notes=this.getNotes(),this.voicings=this.getVoicings(0)},Tabulous.prototype.set=function(a,b){this.settings[a]=b,this.setUp()};